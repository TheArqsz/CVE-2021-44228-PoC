#!/bin/bash
set -e

# Build vuln app
cd vulnapp
sudo rm -rf target/*
docker build -f Dockerfile-build -t mvnbuild --no-cache .
docker run --rm -it -v $(pwd)/target:/vulnapp/target mvnbuild
sudo rm -rf target/archive-tmp target/classes target/generated-sources target/maven-status
mv target/vulnapp-1.0-jar-with-dependencies.jar target/vulnapp.jar
docker image rm mvnbuild
cd ..