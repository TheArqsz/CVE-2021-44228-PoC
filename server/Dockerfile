FROM openjdk:8-slim

RUN apt update || echo "Something went wrong"; apt install -y python3 && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /app

COPY marshalsec-0.0.3.jar /app/marshalsec-0.0.3.jar

COPY entrypoint.sh /app/entry.sh

RUN chmod +x /app/entry.sh

ENV HTTP_HOST 127.0.0.1
ENV HTTP_PORT 8080
ENV HTTP_ENDPOINT exploit
ENV HOST_LDAP_PORT 1389

EXPOSE 1389

COPY scripts/exploit.class /app/$HTTP_ENDPOINT.class

ENTRYPOINT /app/entry.sh
